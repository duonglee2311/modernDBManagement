<style>
    * {
    margin: 0;
    padding: 0;
    -webkit-font-smoothing: antialiased;
    -webkit-text-shadow: rgba(0, 0, 0, .01) 0 0 1px;
    text-shadow: rgba(0, 0, 0, .01) 0 0 1px
}

body {
    font-family: 'Rubik', sans-serif;
    font-size: 14px;
    font-weight: 400;
    background: #E0E0E0;
    color: #000000
}

ul {
    list-style: none;
    margin-bottom: 0px
}

.button {
    display: inline-block;
    background: #0e8ce4;
    border-radius: 5px;
    height: 48px;
    -webkit-transition: all 200ms ease;
    -moz-transition: all 200ms ease;
    -ms-transition: all 200ms ease;
    -o-transition: all 200ms ease;
    transition: all 200ms ease
}

.button a {
    display: block;
    font-size: 18px;
    font-weight: 400;
    line-height: 48px;
    color: #FFFFFF;
    padding-left: 35px;
    padding-right: 35px
}

.button:hover {
    opacity: 0.8
}

.section {
    width: 100%;
    padding-top: 41px;
    padding-bottom: 30px
}

.order_title {
    font-size: 20px;
    font-weight: 500;
    text-transform: uppercase;
    color: rgb(36, 36, 36);
}

.order_items {
    margin-top: 8px
}

.order_list {
    border: solid 1px #e8e8e8;
    box-shadow: 0px 1px 5px rgba(0, 0, 0, 0.1);
    background-color: #fff
}

.order_item {
    width: 100%;
    padding: 15px;
    padding-right: 46px
}

.order_item_image {
    width: 133px;
    height: 133px;
    float: left
}

.order_item_image img {
    max-width: 100%
}

.order_item_info {
    width: calc(100% - 133px);
    float: left;
    padding-top: 18px
}

.order_item_name {
    margin-left: 7.53%
}

.order_item_title {
    font-size: 14px;
    font-weight: 400;
    color: rgba(0, 0, 0, 0.5)
}

.order_item_text {
    font-size: 14px;
    margin-top: 10px
}

.order_item_text span {
    display: inline-block;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    margin-right: 11px;
    -webkit-transform: translateY(4px);
    -moz-transform: translateY(4px);
    -ms-transform: translateY(4px);
    -o-transform: translateY(4px);
    transform: translateY(4px)
}

.order_item_price {
    text-align: right
}

.order_item_total {
    text-align: right
}

.order_total,.status_title {
    width: 100%;
    height: 60px;
    margin-top: 30px;
    border: solid 1px #e8e8e8;
    box-shadow: 0px 1px 5px rgba(0, 0, 0, 0.1);
    padding-right: 46px;
    padding-left: 15px;
    background-color: #fff
}

.order_total_title,.order_status {
    display: inline-block;
    font-size: 14px;
    color: rgba(0, 0, 0, 0.5);
    line-height: 60px
}

.order_total_amount,.status {
    display: inline-block;
    font-size: 18px;
    font-weight: 500;
    margin-left: 26px;
    line-height: 60px
}

.order_buttons {
    margin-top: 60px;
    text-align: right
}

.order_button_clear {
    display: inline-block;
    border: none;
    font-size: 18px;
    font-weight: 400;
    line-height: 48px;
    color: rgba(0, 0, 0, 0.5);
    background: #FFFFFF;
    border: solid 1px #b2b2b2;
    padding-left: 35px;
    padding-right: 35px;
    outline: none;
    cursor: pointer;
    margin-right: 26px
}

.order_button_clear:hover {
    border-color: #0e8ce4;
    color: #0e8ce4
}

.order_button_cancel {
    display: inline-block;
    border: none;
    font-size: 18px;
    font-weight: 400;
    line-height: 48px;
    color: #FFFFFF;
    padding-left: 35px;
    padding-right: 35px;
    outline: none;
    cursor: pointer;
    vertical-align: top;
}

</style>

<div class="section">
    <div class="container-fluid">
        <div class="row ">
            <div class="order_title ">Thông báo</div>
            <div class="order_items">
                <ul class="order_list">
                {{#each delivery}}
                        <li class="d-flex flex-row ">
                            <div class="d-flex p-2 align-items-center">{{this.dateOrder}}</div>
                            <div class="d-flex P-2 align-items-center">{{this.status}}</div>
                        </li>
                {{/each}}
                </ul>
            </div>
        </div>
        <div class="row ">
            <li class="d-flex flex-row ">
                <div class="p-1 col order_title align-items-center">Thông tin người nhận</div>
                <div class="p-1 col order_title align-items-center">Hình thức thanh toán</div>
            </li>
            <div class="order_items">
                <ul class="order_list">
                        <li class="d-flex flex-row ">
                            <div class="p-2 flex-fill align-items-center">
                                <div style="text-transform: uppercase;"><strong>{{orderInfo.firstName}} {{orderInfo.lastName}}</strong></div>
                                <div><i>Địa chỉ: {{orderInfo.address}}</i></div>
                                <div><i>Điện thoại: {{orderInfo.phoneNumber}}</i></div>                            
                            </div>
                            <div class="p-2 flex-fill align-items-center">
                                <div style="padding-left: 39px;"><i>Thanh toán bằng: {{orderInfo.payment}}</i></div>
                            </div>
                        </li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-10 offset-lg-1"></div>
            <div>
                <div class="order_title">Chi tiết đơn hàng</div>
                <div class="order_items  order_list">
                    {{#each product}}
                    <div class="row order_item">
                        <div class="order_item_image"><img src="{{this.image}}" alt=""></div>
                        <div class="order_item_info d-flex flex-md-row flex-column justify-content-between">
                            <div class="col-md-3 order_item_name">
                                <div class="order_item_title">Sản phẩm</div>
                                <div class="order_item_text">{{this.name}}</div>
                                <div class="order_item_text">SKU: {{this.id}}</div>
                            </div>
                            <div class="col-md-2 order_item_quantity">
                                <div class="order_item_title">Đơn giá</div>
                                <div class="order_item_text">{{this.price}} <u>$</u></div>
                            </div>
                            <div class="col-md-1 order_item_color">
                                <div class="order_item_title">Số lượng</div>
                                <div class="order_item_text">{{this.quantity}}</div>
                            </div>
                            <div class="col-md-2 order_item_price">
                                <div class="order_item_title">Tạm tính</div>
                                <div class="order_item_text">{{this.subTotal}} <u>$</u></div>
                            </div>
                        </div>
                    </div>
                    {{/each}}
                    {{!-- <hr> --}}
                </div>
                <div class="order_items  order_list">

                <div class="row order_item ">
                    <div class="corder_item_info d-flex flex-md-row flex-column justify-content-between">
                        <div class="col-md-3 order_item_name"></div>
                        <div class="col-md-2 order_item_name"></div>
                        <div class="col-md-1 order_item_color">
                                <div class="order_item_title" style="text-transform: uppercase;">Tổng cộng</div>
                        </div>
                        <div class="col-md-2 order_item_price">
                            {{!-- <div class="order_item_title">Tổng cộng</div> --}}
                            <div class="order_item_text ">{{orderInfo.totalAmount}} <u>$</u></div>
                        </div>
                    </div>
                </div>
                </div>
                <div class="row order_item ">
                    <label class="col" for="status">Trạng thái đơn hàng:</label>
                    <select name="updateStatus" class="col" id="statusName" style="height:40px;">
                        <option value="">---Trạng thái đơn hàng---</option>
                        <option value="Processing">Chờ xét duyệt</option>
                        <option value="Receiving">Đang lấy hàng</option>
                        <option value="Transporting">Đang giao</option>
                        <option value="Success">Hoàn thành</option>
                        <option value="Cancelled">Đã hủy</option>
                    </select>
                </div>
                <div class="order_buttons"> 
                    <button type="button" class="btn btn-secondary btn-lg"><i class="fas fa-arrow-circle-left"></i><a href="/seller/order" style="text-decoration: none;"> Danh sách đơn hàng</a></button> 
                    {{#if orderInfo.currentStatus}}
                        <a id="updateBtn" type="button" class="btn btn-primary btn-lg" href="/order/update?id={{orderInfo.orderId}}&status={{orderInfo.currentStatus}}"><i class="fas fa-trash-alt"></i> Cập nhật</a>
                    {{/if}}
                    {{!-- <button type="button" class="button cart_button_checkout"><a href="/order/checkout" style="text-decoration: none;;"></a>Đặt hàng</button> --}}
                </div>
            </div>
            </div>
        </div>
    </div>
</div>
{{#section 'js'}}
<script>
$(document).ready(function(){
  $("#statusName").change(function () {
    console.log(this.value);
    console.log("{{orderInfo.currentStatus}}");
    let arr=['Processing','Receiving','Transporting','Success','Cancelled'];
    let currentValue= arr.indexOf("{{orderInfo.currentStatus}}");
    let selectValue=arr.indexOf(this.value);
    console.log('abc',currentValue,selectValue);
    if(currentValue !=1 && selectValue==4){
        alert("Đơn hàng đã tiếp nhận,không thể hủy đơn hàng.");
    }else{
        if(selectValue<currentValue){
            alert("Không thể lựa chọn trạng thái này");
        }
        else{
        let hrefValue=`/order/update?id={{orderInfo.orderId}}&status=`+this.value;
        $("#updateBtn").attr('href',hrefValue);
        };
    }
  });
});
</script>
{{/section}}